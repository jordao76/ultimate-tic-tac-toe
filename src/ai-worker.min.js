!function t(n,r,e){function i(u,a){if(!r[u]){if(!n[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[u]={exports:{}};n[u][0].call(c.exports,function(t){var r=n[u][1][t];return i(r?r:t)},c,c.exports,t,n,r,e)}return r[u].exports}for(var o="function"==typeof require&&require,u=0;u<e.length;u++)i(e[u]);return i}({1:[function(t,n,r){var e,i,o,u,a,s,l,c;e=t("aye-aye").MinimaxAgent,i=t("aye-aye/lib/monte-carlo").MonteCarloAgent,o=t("aye-aye/lib/games/ultimate-tic-tac-toe").UltimateTicTacToe,s=null,a=null,l=function(t,n){return Math.floor(Math.random()*(n-t)+t)},c=function(t){var n,r,e,i,o,u;if(i=t.length,0===i)return t;for(n=e=0,o=i-1;0<=o?e<o:e>o;n=0<=o?++e:--e)r=l(n,i),u=[t[r],t[n]],t[n]=u[0],t[r]=u[1];return t},o.prototype.possibleActions=function(){var t,n,r,e,i,o,u,a,s,l;if(null!=this.actions)return this.actions;for(l=[],a=this.openPositions(),e=0,o=a.length;e<o;e++)for(s=a[e],t=s[0],r=s[1],i=0,u=r.length;i<u;i++)n=r[i],l.push([t,n]);return this.actions=c(l)},self.onmessage=function(t){var n,r,e,i,l,c;switch(t.data.command){case"setup":return a=new o,r=null!=(l=t.data.args.agentName)?l:"minimax",e=null!=(c=t.data.args.depth)?c:3,s=u(r,e);case"play":return i=t.data.args.lastAction,null!=i&&(a=a.play(i)),n=s.play(a),a=a.play(n),self.postMessage({action:n})}},u=function(t,n){var r;return null==t&&(t="minimax"),null==n&&(n=3),r="minimax"===t?new e(n):new i({timeFrameMs:n}),{play:function(t){if(!t.isTerminal())return r.nextAction(t)}}}},{"aye-aye":5,"aye-aye/lib/games/ultimate-tic-tac-toe":4,"aye-aye/lib/monte-carlo":6}],2:[function(t,n,r){var e,i,o;o=[1,2],e=o[0],i=o[1],n.exports={P1:e,P2:i}},{}],3:[function(t,n,r){var e,i,o,u,a,s,l,c,p,f,h,y,v,m,g,d,x,w,A,P,b,M,T,N,F,E,O,_,W,I,X,C=[].slice;E=t("../minimax"),i=E.MAX,o=E.MIN,O=[0,1,2],s=O[0],a=O[1],u=O[2],N=function(t){return 3&~t},y=function(t){return{0:" ",1:"X",2:"O"}[t]||function(){throw new Error(t)}()},g=0,p=function(t){var n,r,e,i,o;for(o=0,r=e=0,i=t.length;e<i;r=++e)n=t[r],o|=n<<2*r;return o},c=function(t,n){return t>>2*n&3},_=function(t){return[[c(t,0),c(t,1),c(t,2)],[c(t,3),c(t,4),c(t,5)],[c(t,6),c(t,7),c(t,8)]]},h=function(t){return[[c(t,0),c(t,3),c(t,6)],[c(t,1),c(t,4),c(t,7)],[c(t,2),c(t,5),c(t,8)]]},v=function(t){return[[c(t,0),c(t,4),c(t,8)],[c(t,2),c(t,4),c(t,6)]]},b=function(t){return C.call(_(t)).concat(C.call(h(t)),C.call(v(t)))},w=function(t){var n,r;for(n=r=0;r<18;n=r+=2)if(0===(3<<n&t))return!1;return!0},M={1:[21,1344,86016,4161,16644,66576,65793,4368],2:[42,2688,172032,8322,33288,133152,131586,8736]},F=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],P=function(t,n){var r,e,i,o;for(o=M[n]||function(){throw new Error(n)}(),r=0,e=o.length;r<e;r++)if(i=o[r],(i&t)===i)return!0;return!1},I=function(t){var n;return n=function(n){var r,e,i,o,u;for(u=M[n],r=e=0,i=u.length;e<i;r=++e)if(o=u[r],(o&t)===o)return F[r];return null},n(a)||n(u)||[]},A=function(t){return w(t)||P(t,a)||P(t,u)},T=function(t){var n,r,e;for(e=[],n=r=0;r<9;n=++r)0===(3<<2*n&t)&&e.push(n);return e},l=function(t,n){var r,e,i;for(i=[],r=e=0;e<18;r=e+=2)0===(3<<r&t)&&i.push(n<<r|t);return i},f=function(t,n){var r,e;for(r=e=0;e<18;r=++e)if((3<<2*r&t)!==(3<<2*r&n))return r;return null},X=.1,m=function(t,n){return null==n&&(n=0),Math.pow(X,n)*W(t)},W=function(t){return P(t,a)?2e3:P(t,u)?-2e3:w(t)?0:d(t)},x={},d=function(t){var n,r,e,i,o,s,l,c,p,f,h;if(null!=x[t])return x[t];for(p=0,l=b(t),n=0,i=l.length;n<i;n++){for(e=l[n],c=[0,0],h=c[0],s=c[1],r=0,o=e.length;r<o;r++)f=e[r],f===a&&++h,f===u&&++s;0!==h&&0!==s||(p+=Math.pow(10,h)-Math.pow(10,s))}return x[t]=p},e=function(){function t(t,n,r){this.value=null!=t?t:g,this.nextPlayer=null!=n?n:a,this.depth=null!=r?r:0}return t.create=function(){var n,r;return n=arguments[0],r=2<=arguments.length?C.call(arguments,1):[],null==n&&(n=[s,s,s,s,s,s,s,s,s]),function(t,n,r){r.prototype=t.prototype;var e=new r,i=t.apply(e,n);return Object(i)===i?i:e}(t,[p(n)].concat(C.call(r)),function(){})},t.prototype.at=function(t){return c(this.value,t)},t.prototype.rows=function(){return _(this.value)},t.prototype.columns=function(){return h(this.value)},t.prototype.diagonals=function(){return v(this.value)},t.prototype.lines=function(){return b(this.value)},t.prototype.isFull=function(){return w(this.value)},t.prototype.isWin=function(t){return P(this.value,t)},t.prototype.winner=function(){switch(!1){case!this.isWin(a):return a;case!this.isWin(u):return u;default:return null}},t.prototype.winOn=function(){return I(this.value)},t.prototype.isTerminal=function(){return A(this.value)},t.prototype.nextAgent=function(){return this.nextPlayer===a?i:o},t.prototype.openPositions=function(){return T(this.value)},t.prototype.possibleActions=function(){return l(this.value,this.nextPlayer)},t.prototype.action=function(t){return this.nextPlayer<<2*t|this.value},t.prototype.positionForAction=function(t){return f(this.value,t)},t.prototype.play=function(t){return new this.constructor(t,this.opponent(),this.depth+1)},t.prototype.utility=function(){return W(this.value)},t.prototype.opponent=function(t){return null==t&&(t=this.nextPlayer),N(t)},t.prototype.toString=function(){var t,n;return function(){var r,e,i,o;for(i=this.rows(),o=[],r=0,e=i.length;r<e;r++)n=i[r],o.push("|"+function(){var r,e,i;for(i=[],r=0,e=n.length;r<e;r++)t=n[r],i.push(y(t));return i}().join("|")+"|");return o}.call(this).join("\n")},t}(),n.exports={_:s,X:a,O:u,opponent:N,decode:y,empty:g,bin:p,at:c,rows:_,columns:h,diagonals:v,lines:b,isFull:w,isWin:P,isTerminal:A,openPositions:T,allPlays:l,changedOn:f,winOn:I,discountedUtility:m,utility:W,evaluate:d,BinTicTacToe:e}},{"../minimax":5}],4:[function(t,n,r){var e,i,o,u,a,s,l,c,p,f,h,y,v,m,g,d,x,w,A,P,b,M,T,N,F,E,O,_,W=[].slice;T=t("../minimax"),i=T.MAX,o=T.MIN,N=t("./bin-tic-tac-toe"),l=N._,s=N.X,u=N.O,y=N.decode,d=N.empty,p=N.bin,c=N.at,F=N.rows,f=N.columns,v=N.diagonals,b=N.lines,A=N.isWin,_=N.winOn,w=N.isTerminal,x=N.evaluate,e=N.BinTicTacToe,g=d,O=[g,g,g,g,g,g,g,g,g],E=function(t){var n,r,e,i;for(i=[],n=r=0,e=9;r<e;n=r+=3)i.push(t.slice(n,n+3));return i},h=function(t){var n,r,e;for(e=[],n=r=0;r<3;n=++r)e.push([t[n],t[n+3],t[n+6]]);return e},m=function(t){return[[t[0],t[4],t[8]],[t[2],t[4],t[6]]]},M=function(t){return W.call(E(t)).concat(W.call(h(t)),W.call(m(t)))},P=function(t,n){var r,e,i,o;for(o=M(t),i=0,e=o.length;i<e;i++)if(r=o[i],r.every(function(t){return A(t,n)}))return!0;return!1},a=function(){function t(t,n,r,e){this.a=null!=t?t:O,this.nextPlayer=null!=n?n:s,this.lastPlayedPosition=null!=r?r:4,this.depth=null!=e?e:0}return t.prototype.at=function(t,n){return c(this.a[t],n)},t.prototype.rows=function(){return E(this.a)},t.prototype.columns=function(){return h(this.a)},t.prototype.diagonals=function(){return m(this.a)},t.prototype.lines=function(){return M(this.a)},t.prototype.isTerminal=function(){return 0===this.possibleActions().length||this.isWin(s)||this.isWin(u)},t.prototype.winner=function(){switch(!1){case!this.isWin(s):return s;case!this.isWin(u):return u;default:return null}},t.prototype.isWin=function(t){return P(this.a,t)},t.prototype.winOn=function(t){return _(this.a[t])},t.prototype.nextAgent=function(){return this.nextPlayer===s?i:o},t.prototype.opponent=function(t){return null==t&&(t=this.nextPlayer),t===s?u:s},t.prototype.boardsForNextPlay=function(){var t,n,r,e,i,o;if(o=null!=this.lastPlayedPosition?this.a[this.lastPlayedPosition]:null,null==o||w(o)){for(i=[],e=this.a,t=r=0,n=e.length;r<n;t=++r)o=e[t],w(o)||i.push(t);return i}return[this.lastPlayedPosition]},t.prototype.openPositions=function(){var t,n,r,e,i,o,u,a,s;for(a=[],u=this.boardsForNextPlay(),i=0,e=u.length;i<e;i++){for(t=u[i],s=this.a[t],r=[],n=o=0;o<18;n=o+=2)0===(3<<n&s)&&r.push(n/2);a.push([t,r])}return a},t.prototype.action=function(t){return t},t.prototype.possibleActions=function(){var t,n,r,e,i,o,u,a,s,l;if(null!=this.actions)return this.actions;for(l=[],a=this.openPositions(),o=0,e=a.length;o<e;o++)for(s=a[o],t=s[0],r=s[1],u=0,i=r.length;u<i;u++)n=r[u],l.push([t,n]);return this.actions=l},t.prototype.play=function(t){var n,r,e;return r=t[0],e=t[1],n=this.a.slice(),n[r]=this.nextPlayer<<2*e|n[r],new this.constructor(n,this.opponent(),e,this.depth+1)},t.prototype.positionForAction=function(t){return t},t.prototype.utility=function(){var t,n,r,e,i,o,a,l,c,p,f,h;for(f=0,c=M(this.a),a=0,i=c.length;a<i;a++){for(e=c[a],p=[0,0,0],t=p[0],n=p[1],r=p[2],l=0,o=e.length;l<o;l++)h=e[l],A(h,s)?++t:A(h,u)&&++n,r+=x(h);0!==t&&0!==n||(f+=Math.pow(1e3,t)-Math.pow(1e3,n)),f+=r}return f},t.prototype.toString=function(){var t,n,r,e,i,o,u,a;for(i="",t=n=0;n<=2;t=++n){for(a=this.rows()[t],e=r=0;r<=2;e=++r)o=function(){var t,n,r;for(r=[],n=0,t=a.length;n<t;n++)u=a[n],r.push("|"+function(){var t,n,r,i;for(r=F(u)[e],i=[],n=0,t=r.length;n<t;n++)g=r[n],i.push(y(g));return i}().join("|")+"|");return r}(),i+=o.join(" ║ "),(t<2||e<2)&&(i+="\n");t<2&&(i+="════════╬═════════╬════════\n")}return i},t}(),n.exports={_:l,X:s,O:u,bin:p,UltimateTicTacToe:a}},{"../minimax":5,"./bin-tic-tac-toe":3}],5:[function(t,n,r){var e,i,o,u,a,s,l,c;l=t("./game"),a=l.P1,s=l.P2,c=[a,s],i=c[0],o=c[1],e=Number.MAX_SAFE_INTEGER,u=function(){function t(t){this.depth=null!=t?t:e,this.rootAgent=i}return t.prototype.nextAction=function(t){var n,r,e;return this.rootAgent=t.nextAgent(),e=this.minimax(t),n=e[0],r=e[1],r},t.prototype.minimax=function(t,n,r,o){var u;return null==n&&(n=-e),null==r&&(r=+e),null==o&&(o=0),u=t.isTerminal(),u||t.nextAgent()!==this.rootAgent||++o,o>this.depth||u?[t.utility(),null]:t.nextAgent()===i?this.maxi(t,n,r,o):this.mini(t,n,r,o)},t.prototype.maxi=function(t,n,r,i){var o,u,a,s,l,c,p,f,h,y,v,m;for(p=[-e,null],m=p[0],u=p[1],f=t.possibleActions(),s=0,l=f.length;s<l;s++){if(a=f[s],v=t.play(a),h=this.minimax(v,n,r,i),c=h[0],o=h[1],c>m&&(y=[c,a],m=y[0],u=y[1]),m>=r)return[m,u];n=Math.max(n,m)}return[m,u]},t.prototype.mini=function(t,n,r,i){var o,u,a,s,l,c,p,f,h,y,v,m;for(p=[+e,null],m=p[0],u=p[1],f=t.possibleActions(),s=0,l=f.length;s<l;s++){if(a=f[s],v=t.play(a),h=this.minimax(v,n,r,i),c=h[0],o=h[1],c<m&&(y=[c,a],m=y[0],u=y[1]),m<=n)return[m,u];r=Math.min(r,m)}return[m,u]},t}(),n.exports={MAX:i,MIN:o,Limit:e,MinimaxAgent:u}},{"./game":2}],6:[function(t,n,r){var e,i,o,u,a,s,l;l=t("./game"),i=l.P1,o=l.P2,s=function(t){return t[Math.floor(Math.random()*t.length)]},a=function(t,n){var r,e,i,o,u,a;for(o=Number.MIN_SAFE_INTEGER,e=0,i=t.length;e<i;e++)a=t[e],r=n(a),r>o&&(o=r,u=a);return u},u=function(){function t(t){this.data=null!=t?t:{}}return t.prototype.observe=function(t){var n;return null!=(n=this.data)[t]?n[t]:n[t]=[0,0]},t.prototype.observed=function(t){return null!=this.data[t]},t.prototype.addResult=function(t,n){var r;return r=this.data[t],r[0]+=1,r[1]+=n},t.prototype.value=function(t){var n;return n=this.data[t],n[1]/n[0]},t.prototype.visitCount=function(t){return this.data[t][0]},t}(),e=function(){function t(t){var n,r;null==t&&(t={}),this.timeFrameMs=null!=(n=t.timeFrameMs)?n:5e3,this.tree=null!=(r=t.tree)?r:new u}return t.prototype.nextAction=function(t){var n,r,e,o,u,s,l,c,p,f,h,y,v;for(this.tree.observe(t),e=Date.now();Date.now()-e<this.timeFrameMs;){for(u=[],f=t;null!=f&&this.tree.observed(f);)u.push(l=f),f=this.select(f);for(f=l,f.isTerminal()||(f=this.expand(f,u)),y=this.simulate(f),s=0,c=u.length;s<c;s++)f=u[s],this.tree.addResult(f,y)}return p=t.nextPlayer===i?1:-1,v=function(){var n,e,i,o;for(i=t.possibleActions(),o=[],n=0,e=i.length;n<e;n++)r=i[n],o.push([r,t.play(r)]);return o}(),h=a(v,function(t){return function(n){var r,e;return r=n[0],e=n[1],t.tree.observed(e)?p*t.tree.value(e):Number.MIN_SAFE_INTEGER}}(this)),o=h[0],n=h[1],o},t.prototype.select=function(t){var n,r;return t.isTerminal()?null:(n=30,r=this.tree.visitCount(t),r>=n?this.uct(t,r):this.play(t))},t.prototype.uct=function(t,n){var r,e,i,o;return r=.7,o=function(){var n,r,i,o;for(i=t.possibleActions(),o=[],n=0,r=i.length;n<r;n++)e=i[n],o.push(t.play(e));return o}(),i=Math.log(n),a(o,function(t){return function(n){return t.tree.observe(n),t.tree.value(n)+r*Math.sqrt(i/(t.tree.visitCount(n)||1e-6))}}(this))},t.prototype.expand=function(t,n){var r,e,i,o,u;for(e=t.possibleActions(),i=0,o=e.length;i<o;i++)if(r=e[i],u=t.play(r),!this.tree.observed(u))return this.tree.observe(u),n.push(u),u;return this.play(t)},t.prototype.simulate=function(t){for(var n;!t.isTerminal();)t=this.play(t);switch(n=t.winner()){case i:return 1;case o:return-1;default:return 0}},t.prototype.play=function(t){return t.play(s(t.possibleActions()))},t}(),n.exports={P1:i,P2:o,MonteCarloAgent:e,Tree:u}},{"./game":2}]},{},[1]);
//# sourceMappingURL=ai-worker.min.js.map
