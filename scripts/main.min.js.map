{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","app/scripts/highlight.coffee","main.min.js","app/scripts/index.coffee","app/scripts/spinner.coffee","app/scripts/web-rtc.coffee","node_modules/aye-aye/lib/games/bin-tic-tac-toe.js","node_modules/aye-aye/lib/games/ultimate-tic-tac-toe.js","node_modules/aye-aye/lib/minimax.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","$","jQuery","fn","highlight","this","each","el","width","outerWidth","height","outerHeight","css","position","left","offset","top","background-color","opacity","z-index","appendTo","fadeOut","queue","remove",2,"O","RTC","UltimateTicTacToe","X","decode","hideSpinner","ref","ref1","showSpinner","checkGameOver","computerPlayer","createPlayerO","createPlayerX","game","humanPlayer","lastAction","markWins","next","playAction","playable","playerO","playerText","playerX","players","remotePlayer","setup","swapPlayers","teardown","unplayable","className","j","k","len","ref2","ref3","nextPlayer","possibleActions","addClass","removeClass","off","results","wonBy","wonClass","winOn","at","push","isTerminal","text","isWin","show","toLowerCase","action","play","player","human","peer","host","dumb AI","so-so AI","smart AI","super AI","playerName","$o","$x","tmp","html","on","$btn","$player","currentPlayerName","playerFor","data","int","parseAction","parseInt","match","done","playableClassName","$tile","get","id","depth","worker","Worker","onmessage","postMessage","command","args","terminate","ondatachannelopen","isHost","ondisconnected","newGame","send","hide","./highlight","./spinner","./web-rtc","aye-aye/lib/games/bin-tic-tac-toe","aye-aye/lib/games/ultimate-tic-tac-toe",3,"spinner","spinnerThresholdMs","spinnerTimeout","Spinner","lines","radius","target","setTimeout","spin","clearTimeout","stop",4,"Guest","Host","RTCPeerConnection","RTCSessionDescription","configuration","constraints","window","mozRTCPeerConnection","webkitRTCPeerConnection","msRTCPeerConnection","mozRTCSessionDescription","webkitRTCSessionDescription","msRTCSessionDescription","iceServers","url","optional","DtlsSrtpKeyAgreement","peerConnection","dataChannel","onicecandidate","_this","candidate","onoffercreated","JSON","stringify","localDescription","prototype","setupDataChannel","createDataChannel","reliable","onopen","oniceconnectionstatechange","iceConnectionState","onchannelopen","parse","createOffer","offerDesc","setLocalDescription","console","warn","acceptAnswer","answerJSON","setRemoteDescription","onanswercreated","ondatachannel","channel","offer","offerJSON","createAnswer","answerDesc","gameRef","key","Math","random","Firebase","onDisconnect","set","location","hash","log","href","snap","val","answer","m","guest","isGuest","substring","update","once",5,"BinTicTacToe","MAX","MIN","_","allPlays","bin","changedOn","columns","diagonals","discountedUtility","empty","evaluate","evaluateCache","isFull","masks","openPositions","opponent","positions","rows","utility","γ","slice","W","res","v","concat","ms","w","v1","v2","pow","len1","score","x","value1","depth1","value","create","arguments","func","ctor","child","result","apply","Object","nextAgent","positionForAction","constructor","toString","results1","join","../minimax",6,"columnsU","diagonalsU","isWinU","linesU","rowsU","ultimateEmpty","every","a1","lastPlayedPosition","who","boardsForNextPlay","js","ij","actions","arg","bri","ri","strRows","vs","p","./bin-tic-tac-toe",7,"MinimaxAgent","Infinity","rootAgent","nextAction","state","bestAction","minimax","α","β","ply","maxi","mini","nextValue","ref4","successor","max","min"],"mappings":"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","file":"main.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","$ = jQuery\r\n\r\n$.fn.highlight = ->\r\n  ($ this).each ->\r\n    el = $ this\r\n    $ '<div/>'\r\n      .width el.outerWidth()\r\n      .height el.outerHeight()\r\n      .css\r\n        'position': 'absolute'\r\n        'left': el.offset().left\r\n        'top': el.offset().top\r\n        'background-color': '#ffff77'\r\n        'opacity': .7\r\n        'z-index': 10\r\n      .appendTo 'body'\r\n      .fadeOut 1000\r\n      .queue -> ($ this).remove()\r\n",null,"# coffeelint: disable=max_line_length\n\n$ = jQuery\n\n{X, O, decode} = require 'aye-aye/lib/games/bin-tic-tac-toe'\n{UltimateTicTacToe} = require 'aye-aye/lib/games/ultimate-tic-tac-toe'\n\n{showSpinner, hideSpinner} = require './spinner'\nrequire './highlight'\n\n{RTC} = require './web-rtc'\n\n$ ->\n\n  game = null\n  lastAction = null\n\n  playable = ->\n    className =\n      if game.nextPlayer is X then 'x-playable-tile' else 'o-playable-tile'\n    for [i, j] in game.possibleActions()\n      $ \"##{i}\\\\,#{j}\"\n        .addClass className\n    className\n\n  unplayable = ->\n    $ '.tile'\n      .removeClass 'x-playable-tile'\n      .removeClass 'o-playable-tile'\n      .removeClass 'human-playable-tile'\n      .off 'click'\n\n  markWins = ->\n    for i in [0...9]\n      wonBy = null\n      for j in game.winOn i\n        wonBy = game.at i, j\n        wonClass = if wonBy is X then 'x-won-tile' else 'o-won-tile'\n        ($ \"##{i}\\\\,#{j}\").addClass wonClass\n      if wonBy?\n        wonClass = if wonBy is X then 'x-won-board' else 'o-won-board'\n        ($ '#' + i).addClass wonClass\n\n  checkGameOver = ->\n    return no unless game.isTerminal()\n    $ '#info'\n      .text switch\n        when game.isWin(X) then 'X Wins!'\n        when game.isWin(O) then 'O Wins!'\n        else 'Draw!'\n    $ '#info-container'\n      .show()\n    yes\n\n  playerText = -> (decode game.nextPlayer).toLowerCase()\n\n  playAction = (action) ->\n    [i, j] = action\n    hideSpinner()\n    $ \"##{i}\\\\,#{j}\"\n      .text playerText()\n      .highlight()\n    game = game.play action\n    lastAction = action\n    next()\n\n  # player :: {\n  #   setup : (done: ->) ->\n  #   teardown : ->\n  #   play : ->\n  # }\n\n  playerX = null\n  playerO = null\n\n  next = ->\n    unplayable()\n    markWins()\n    player = if game.nextPlayer is X then playerX else playerO\n    player.play()\n\n  players =\n    human: -> humanPlayer()\n    peer: ->\n      RTC.host()\n      remotePlayer()\n    'dumb AI': -> computerPlayer 1\n    'so-so AI': -> computerPlayer 2\n    'smart AI': -> computerPlayer 3\n    'super AI': -> computerPlayer 4\n\n  createPlayerX = ->\n    playerName = ($ '#btn-player-x').text()\n    players[playerName]()\n  createPlayerO = ->\n    playerName = ($ '#btn-player-o').text()\n    players[playerName]()\n\n  swapPlayers = ->\n    $x = $ '#btn-player-x'\n    $o = $ '#btn-player-o'\n    tmp = $x.html()\n    $x.html $o.html()\n    $o.html tmp\n\n  $ '.player'\n    .on 'click', ->\n      $player = $ this\n      playerFor = $player.data 'player-for'\n      $btn = $ \"#btn-player-#{playerFor}\"\n      playerName = $player.text()\n      currentPlayerName = $btn.text()\n      if currentPlayerName isnt playerName\n        $btn.text playerName\n        setup()\n\n  humanPlayer = ->\n    int = (s) -> parseInt s, 10\n    parseAction = (text) ->\n      match = text.match /(\\d),(\\d)/\n      [(int match[1]), (int match[2])]\n    setup: (done) -> done()\n    play: ->\n      return if checkGameOver()\n      playableClassName = playable()\n      $ \".#{playableClassName}\"\n        .addClass 'human-playable-tile'\n        .on 'click', ->\n          $tile = $ this\n          action = parseAction $tile.get(0).id\n          playAction action\n\n  computerPlayer = (depth = 3) ->\n    worker = new Worker 'scripts/minimax-worker.min.js'\n    setup: (done) ->\n      worker.onmessage = (e) -> playAction e.data.action\n      worker.postMessage command: 'setup', args: {depth}\n      done()\n    play: ->\n      return if checkGameOver()\n      playable()\n      showSpinner()\n      worker.postMessage command: 'play', args: {lastAction}\n    teardown: -> worker.terminate()\n\n  RTC.ondatachannelopen = ->\n    if RTC.isHost\n      createPlayerX = -> humanPlayer()\n      createPlayerO = -> remotePlayer()\n    else\n      createPlayerX = -> remotePlayer()\n      createPlayerO = -> humanPlayer()\n    setup()\n  RTC.ondisconnected = ->\n    #TODO\n\n  remotePlayer = ->\n    newGame = -> RTC.send \"new\"\n    ($ '#btn-new-game').on 'click', newGame\n    RTC.onmessage = (data) ->\n      if data is \"new\" then setup() else playAction data\n    setup: (done) -> done()\n    play: ->\n      unless checkGameOver()\n        playable()\n        showSpinner()\n      RTC.send lastAction if lastAction?\n    teardown: -> ($ '#btn-new-game').off 'click', newGame\n\n  setup = ->\n    teardown()\n    game = new UltimateTicTacToe\n    lastAction = null\n    [playerX, playerO] = [createPlayerX(), createPlayerO()]\n    playerX.setup -> playerO.setup -> next()\n\n  teardown = ->\n    playerX?.teardown?()\n    playerO?.teardown?()\n    hideSpinner()\n    $ '.tic-tac-toe'\n      .removeClass 'x-won-board'\n      .removeClass 'o-won-board'\n    $ '.tile'\n      .removeClass 'x-won-tile'\n      .removeClass 'o-won-tile'\n      .text ''\n\n  $ '#btn-new-game'\n    .on 'click', ->\n      ($ '#info-container').hide()\n      swapPlayers()\n      setup()\n\n  ($ '#info-container').hide()\n  setup()\n","$ = jQuery\r\n\r\nspinner = new Spinner lines: 9, radius: 7, length: 7\r\nspinnerTimeout = null\r\nspinnerThresholdMs = 100\r\nshowSpinner = ->\r\n  unless spinnerTimeout?\r\n    target = ($ '#spinner').get 0\r\n    spinnerTimeout =\r\n      setTimeout (-> spinner.spin target), spinnerThresholdMs\r\nhideSpinner = ->\r\n  clearTimeout spinnerTimeout if spinnerTimeout?\r\n  spinner.stop()\r\n  spinnerTimeout = null\r\n\r\nmodule.exports = {showSpinner, hideSpinner}\r\n","# coffeelint: disable=max_line_length\r\n\r\nRTCPeerConnection =\r\n  window.RTCPeerConnection or\r\n  window.mozRTCPeerConnection or\r\n  window.webkitRTCPeerConnection or\r\n  window.msRTCPeerConnection\r\nRTCSessionDescription =\r\n  window.RTCSessionDescription or\r\n  window.mozRTCSessionDescription or\r\n  window.webkitRTCSessionDescription or\r\n  window.msRTCSessionDescription\r\n\r\nconfiguration = iceServers: [url: 'stun:23.21.150.121']\r\nconstraints = optional: [DtlsSrtpKeyAgreement: true]\r\n\r\nclass Host\r\n\r\n  constructor: ->\r\n    @peerConnection = new RTCPeerConnection configuration, constraints\r\n    @dataChannel = null\r\n\r\n    @peerConnection.onicecandidate = (e) =>\r\n      if e.candidate is null\r\n        @onoffercreated JSON.stringify @peerConnection.localDescription\r\n\r\n  setupDataChannel: ->\r\n    @dataChannel = @peerConnection.createDataChannel 'data', reliable: true\r\n    @dataChannel.onopen = =>\r\n      @peerConnection.oniceconnectionstatechange = =>\r\n        if @peerConnection.iceConnectionState is 'disconnected'\r\n          @ondisconnected?()\r\n      @onchannelopen()\r\n    @dataChannel.onmessage = (e) => @onmessage JSON.parse e.data\r\n\r\n  createOffer: ->\r\n    @setupDataChannel() # note: it's important to create the data channel before creating the offer\r\n    @peerConnection.createOffer ((offerDesc) => @peerConnection.setLocalDescription offerDesc),\r\n      -> console.warn \"Couldn't create offer\"\r\n\r\n  acceptAnswer: (answerJSON) ->\r\n    @peerConnection.setRemoteDescription new RTCSessionDescription JSON.parse answerJSON\r\n\r\n  send: (data) -> @dataChannel.send JSON.stringify data\r\n\r\nclass Guest\r\n\r\n  constructor: ->\r\n    @peerConnection = new RTCPeerConnection configuration, constraints\r\n    @dataChannel = null\r\n\r\n    @peerConnection.onicecandidate = (e) =>\r\n      if e.candidate is null\r\n        @onanswercreated JSON.stringify @peerConnection.localDescription\r\n\r\n    @peerConnection.ondatachannel = (e) =>\r\n      @dataChannel = e.channel or e\r\n      @dataChannel.onopen = =>\r\n        @peerConnection.oniceconnectionstatechange = =>\r\n          if @peerConnection.iceConnectionState is 'disconnected'\r\n            @ondisconnected?()\r\n        @onchannelopen()\r\n      @dataChannel.onmessage = (e) => @onmessage JSON.parse e.data\r\n\r\n  offer: (offerJSON) ->\r\n    @peerConnection.setRemoteDescription new RTCSessionDescription JSON.parse offerJSON\r\n    @peerConnection.createAnswer ((answerDesc) => @peerConnection.setLocalDescription answerDesc),\r\n      -> console.warn \"Couldn't create answer\"\r\n\r\n  send: (data) -> @dataChannel.send JSON.stringify data\r\n\r\nmodule.exports = {Host, Guest}\r\n\r\n# WebRTC with Firebase as a signaling service\r\n\r\nRTC =\r\n\r\n  host: ->\r\n    @isHost = yes\r\n    host = new Host\r\n    key = Math.random()*99999+10000|0\r\n    gameRef = new Firebase 'https://ut3.firebaseio.com/' + key\r\n    host.onoffercreated = (offerJSON) ->\r\n      gameRef.onDisconnect().remove()\r\n      gameRef.set offer: JSON.parse offerJSON\r\n      window.location.hash = key\r\n      console.log 'Give this URL to the other player:'\r\n      console.log window.location.href\r\n      gameRef.on 'value', (snap) ->\r\n        data = snap.val()\r\n        return unless data?.answer?\r\n        host.acceptAnswer JSON.stringify data.answer\r\n    host.ondisconnected = ->\r\n      console.log 'peer disconnected!'\r\n      window.location.hash = ''\r\n      RTC.ondisconnected?()\r\n    host.onchannelopen = ->\r\n      console.log 'channel open'\r\n      RTC.send = (m) -> host.send m\r\n      gameRef.off 'value'\r\n      RTC.ondatachannelopen?()\r\n    host.onmessage = (data) ->\r\n      console.log 'HOST: got data', data\r\n      RTC.onmessage? data\r\n    host.createOffer()\r\n\r\n  guest: ->\r\n    hash = window.location.hash\r\n    return unless hash\r\n    @isGuest = yes\r\n    gameRef = new Firebase 'https://ut3.firebaseio.com/' + hash.substring 1\r\n    guest = new Guest\r\n    guest.onanswercreated = (answerJSON) ->\r\n      gameRef.update answer: JSON.parse answerJSON\r\n    guest.ondisconnected = ->\r\n      console.log 'peer disconnected!'\r\n      window.location.hash = ''\r\n      RTC.ondisconnected?()\r\n    guest.onchannelopen = ->\r\n      console.log 'channel open'\r\n      RTC.send = (m) -> guest.send m\r\n      RTC.ondatachannelopen?()\r\n    guest.onmessage = (data) ->\r\n      console.log 'GUEST: got data', data\r\n      RTC.onmessage? data\r\n    gameRef.once 'value', (snap) ->\r\n      data = snap.val()\r\n      if data?.offer?\r\n        guest.offer JSON.stringify data.offer\r\n      else\r\n        console.log 'HOST offer not found for game ' + hash\r\n        window.location.hash = ''\r\n\r\njQuery -> RTC.guest()\r\n\r\nmodule.exports.RTC = RTC\r\n","var BinTicTacToe, MAX, MIN, O, X, _, allPlays, at, bin, changedOn, columns, decode, diagonals, discountedUtility, empty, evaluate, evaluateCache, isFull, isTerminal, isWin, lines, masks, openPositions, opponent, positions, ref, ref1, rows, utility, winOn, γ,\n  slice = [].slice;\n\nref = require('../minimax'), MAX = ref.MAX, MIN = ref.MIN;\n\nref1 = [0x0, 0x1, 0x2], _ = ref1[0], X = ref1[1], O = ref1[2];\n\nopponent = function(W) {\n  return ~W & 0x3;\n};\n\ndecode = function(W) {\n  return {\n    0x0: ' ',\n    0x1: 'X',\n    0x2: 'O'\n  }[W] || (function() {\n    throw new Error(W);\n  })();\n};\n\nempty = 0x0;\n\nbin = function(a) {\n  var e, i, j, len, res;\n  res = 0;\n  for (i = j = 0, len = a.length; j < len; i = ++j) {\n    e = a[i];\n    res |= e << (i * 2);\n  }\n  return res;\n};\n\nat = function(v, i) {\n  return v >> (i * 2) & 0x3;\n};\n\nrows = function(v) {\n  return [[at(v, 0), at(v, 1), at(v, 2)], [at(v, 3), at(v, 4), at(v, 5)], [at(v, 6), at(v, 7), at(v, 8)]];\n};\n\ncolumns = function(v) {\n  return [[at(v, 0), at(v, 3), at(v, 6)], [at(v, 1), at(v, 4), at(v, 7)], [at(v, 2), at(v, 5), at(v, 8)]];\n};\n\ndiagonals = function(v) {\n  return [[at(v, 0), at(v, 4), at(v, 8)], [at(v, 2), at(v, 4), at(v, 6)]];\n};\n\nlines = function(v) {\n  return slice.call(rows(v)).concat(slice.call(columns(v)), slice.call(diagonals(v)));\n};\n\nisFull = function(v) {\n  var i, j;\n  for (i = j = 0; j < 18; i = j += 2) {\n    if ((0x3 << i & v) === 0) {\n      return false;\n    }\n  }\n  return true;\n};\n\nmasks = {\n  0x1: [0x15, 0x540, 0x15000, 0x1041, 0x4104, 0x10410, 0x10101, 0x1110],\n  0x2: [0x2a, 0xa80, 0x2a000, 0x2082, 0x8208, 0x20820, 0x20202, 0x2220]\n};\n\npositions = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];\n\nisWin = function(v, W) {\n  var j, len, m, ms;\n  ms = masks[W] || (function() {\n    throw new Error(W);\n  })();\n  for (j = 0, len = ms.length; j < len; j++) {\n    m = ms[j];\n    if ((m & v) === m) {\n      return true;\n    }\n  }\n  return false;\n};\n\nwinOn = function(v) {\n  var w;\n  w = function(W) {\n    var i, j, len, m, ms;\n    ms = masks[W];\n    for (i = j = 0, len = ms.length; j < len; i = ++j) {\n      m = ms[i];\n      if ((m & v) === m) {\n        return positions[i];\n      }\n    }\n    return null;\n  };\n  return (w(X)) || (w(O)) || [];\n};\n\nisTerminal = function(v) {\n  return (isFull(v)) || (isWin(v, X)) || (isWin(v, O));\n};\n\nopenPositions = function(v) {\n  var i, j, results;\n  results = [];\n  for (i = j = 0; j < 9; i = ++j) {\n    if ((0x3 << (i * 2) & v) === 0) {\n      results.push(i);\n    }\n  }\n  return results;\n};\n\nallPlays = function(v, W) {\n  var i, j, res;\n  res = [];\n  for (i = j = 0; j < 18; i = j += 2) {\n    if ((0x3 << i & v) === 0) {\n      res.push(W << i | v);\n    }\n  }\n  return res;\n};\n\nchangedOn = function(v1, v2) {\n  var i, j;\n  for (i = j = 0; j < 18; i = ++j) {\n    if ((0x3 << (i * 2) & v1) !== (0x3 << (i * 2) & v2)) {\n      return i;\n    }\n  }\n  return null;\n};\n\nγ = 0.1;\n\ndiscountedUtility = function(v, depth) {\n  if (depth == null) {\n    depth = 0;\n  }\n  return Math.pow(γ, depth) * utility(v);\n};\n\nutility = function(v) {\n  if (isWin(v, X)) {\n    return 2000;\n  } else if (isWin(v, O)) {\n    return -2000;\n  } else if (isFull(v)) {\n    return 0;\n  } else {\n    return evaluate(v);\n  }\n};\n\nevaluateCache = {};\n\nevaluate = function(v) {\n  var j, k, l, len, len1, o, ref2, ref3, score, w, x;\n  if (evaluateCache[v] != null) {\n    return evaluateCache[v];\n  }\n  score = 0;\n  ref2 = lines(v);\n  for (j = 0, len = ref2.length; j < len; j++) {\n    l = ref2[j];\n    ref3 = [0, 0], x = ref3[0], o = ref3[1];\n    for (k = 0, len1 = l.length; k < len1; k++) {\n      w = l[k];\n      if (w === X) {\n        ++x;\n      }\n      if (w === O) {\n        ++o;\n      }\n    }\n    if (x === 0 || o === 0) {\n      score += Math.pow(10, x) - Math.pow(10, o);\n    }\n  }\n  return evaluateCache[v] = score;\n};\n\nBinTicTacToe = (function() {\n  BinTicTacToe.create = function() {\n    var a, args;\n    a = arguments[0], args = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n    if (a == null) {\n      a = [_, _, _, _, _, _, _, _, _];\n    }\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(BinTicTacToe, [bin(a)].concat(slice.call(args)), function(){});\n  };\n\n  function BinTicTacToe(value1, nextPlayer, depth1) {\n    this.value = value1 != null ? value1 : empty;\n    this.nextPlayer = nextPlayer != null ? nextPlayer : X;\n    this.depth = depth1 != null ? depth1 : 0;\n  }\n\n  BinTicTacToe.prototype.at = function(i) {\n    return at(this.value, i);\n  };\n\n  BinTicTacToe.prototype.rows = function() {\n    return rows(this.value);\n  };\n\n  BinTicTacToe.prototype.columns = function() {\n    return columns(this.value);\n  };\n\n  BinTicTacToe.prototype.diagonals = function() {\n    return diagonals(this.value);\n  };\n\n  BinTicTacToe.prototype.lines = function() {\n    return lines(this.value);\n  };\n\n  BinTicTacToe.prototype.isFull = function() {\n    return isFull(this.value);\n  };\n\n  BinTicTacToe.prototype.isWin = function(W) {\n    return isWin(this.value, W);\n  };\n\n  BinTicTacToe.prototype.winOn = function() {\n    return winOn(this.value);\n  };\n\n  BinTicTacToe.prototype.isTerminal = function() {\n    return isTerminal(this.value);\n  };\n\n  BinTicTacToe.prototype.nextAgent = function() {\n    if (this.nextPlayer === X) {\n      return MAX;\n    } else {\n      return MIN;\n    }\n  };\n\n  BinTicTacToe.prototype.openPositions = function() {\n    return openPositions(this.value);\n  };\n\n  BinTicTacToe.prototype.possibleActions = function() {\n    return allPlays(this.value, this.nextPlayer);\n  };\n\n  BinTicTacToe.prototype.action = function(i) {\n    return this.nextPlayer << (i * 2) | this.value;\n  };\n\n  BinTicTacToe.prototype.positionForAction = function(action) {\n    return changedOn(this.value, action);\n  };\n\n  BinTicTacToe.prototype.play = function(value) {\n    return new this.constructor(value, this.opponent(), this.depth + 1);\n  };\n\n  BinTicTacToe.prototype.utility = function() {\n    return utility(this.value);\n  };\n\n  BinTicTacToe.prototype.opponent = function(W) {\n    if (W == null) {\n      W = this.nextPlayer;\n    }\n    return opponent(W);\n  };\n\n  BinTicTacToe.prototype.toString = function() {\n    var e, r;\n    return ((function() {\n      var j, len, ref2, results;\n      ref2 = this.rows();\n      results = [];\n      for (j = 0, len = ref2.length; j < len; j++) {\n        r = ref2[j];\n        results.push(\"|\" + (((function() {\n          var k, len1, results1;\n          results1 = [];\n          for (k = 0, len1 = r.length; k < len1; k++) {\n            e = r[k];\n            results1.push(decode(e));\n          }\n          return results1;\n        })()).join('|')) + \"|\");\n      }\n      return results;\n    }).call(this)).join(\"\\n\");\n  };\n\n  return BinTicTacToe;\n\n})();\n\nmodule.exports = {\n  _: _,\n  X: X,\n  O: O,\n  opponent: opponent,\n  decode: decode,\n  empty: empty,\n  bin: bin,\n  at: at,\n  rows: rows,\n  columns: columns,\n  diagonals: diagonals,\n  lines: lines,\n  isFull: isFull,\n  isWin: isWin,\n  isTerminal: isTerminal,\n  openPositions: openPositions,\n  allPlays: allPlays,\n  changedOn: changedOn,\n  winOn: winOn,\n  discountedUtility: discountedUtility,\n  utility: utility,\n  evaluate: evaluate,\n  BinTicTacToe: BinTicTacToe\n};\n","var BinTicTacToe, MAX, MIN, O, UltimateTicTacToe, X, _, at, bin, columns, columnsU, decode, diagonals, diagonalsU, e, empty, evaluate, isTerminal, isWin, isWinU, lines, linesU, ref, ref1, rows, rowsU, ultimateEmpty, winOn,\n  slice = [].slice;\n\nref = require('../minimax'), MAX = ref.MAX, MIN = ref.MIN;\n\nref1 = require('./bin-tic-tac-toe'), _ = ref1._, X = ref1.X, O = ref1.O, decode = ref1.decode, empty = ref1.empty, bin = ref1.bin, at = ref1.at, rows = ref1.rows, columns = ref1.columns, diagonals = ref1.diagonals, lines = ref1.lines, isWin = ref1.isWin, winOn = ref1.winOn, isTerminal = ref1.isTerminal, evaluate = ref1.evaluate, BinTicTacToe = ref1.BinTicTacToe;\n\ne = empty;\n\nultimateEmpty = [e, e, e, e, e, e, e, e, e];\n\nrowsU = function(a) {\n  var i, m, ref2, results;\n  results = [];\n  for (i = m = 0, ref2 = 3 * 3; m < ref2; i = m += 3) {\n    results.push(a.slice(i, i + 3));\n  }\n  return results;\n};\n\ncolumnsU = function(a) {\n  var i, m, results;\n  results = [];\n  for (i = m = 0; m < 3; i = ++m) {\n    results.push([a[i], a[i + 3], a[i + 6]]);\n  }\n  return results;\n};\n\ndiagonalsU = function(a) {\n  return [[a[0], a[4], a[8]], [a[2], a[4], a[6]]];\n};\n\nlinesU = function(a) {\n  return slice.call(rowsU(a)).concat(slice.call(columnsU(a)), slice.call(diagonalsU(a)));\n};\n\nisWinU = function(a, W) {\n  var l, len, m, ref2;\n  ref2 = linesU(a);\n  for (m = 0, len = ref2.length; m < len; m++) {\n    l = ref2[m];\n    if (l.every(function(v) {\n      return isWin(v, W);\n    })) {\n      return true;\n    }\n  }\n  return false;\n};\n\nUltimateTicTacToe = (function() {\n  function UltimateTicTacToe(a1, nextPlayer, lastPlayedPosition, depth) {\n    this.a = a1 != null ? a1 : ultimateEmpty;\n    this.nextPlayer = nextPlayer != null ? nextPlayer : X;\n    this.lastPlayedPosition = lastPlayedPosition != null ? lastPlayedPosition : 4;\n    this.depth = depth != null ? depth : 0;\n  }\n\n  UltimateTicTacToe.prototype.at = function(i, j) {\n    return at(this.a[i], j);\n  };\n\n  UltimateTicTacToe.prototype.rows = function() {\n    return rowsU(this.a);\n  };\n\n  UltimateTicTacToe.prototype.columns = function() {\n    return columnsU(this.a);\n  };\n\n  UltimateTicTacToe.prototype.diagonals = function() {\n    return diagonalsU(this.a);\n  };\n\n  UltimateTicTacToe.prototype.lines = function() {\n    return linesU(this.a);\n  };\n\n  UltimateTicTacToe.prototype.isTerminal = function() {\n    return (this.possibleActions().length === 0) || (this.isWin(X)) || (this.isWin(O));\n  };\n\n  UltimateTicTacToe.prototype.isWin = function(W) {\n    return isWinU(this.a, W);\n  };\n\n  UltimateTicTacToe.prototype.winOn = function(i) {\n    return winOn(this.a[i]);\n  };\n\n  UltimateTicTacToe.prototype.nextAgent = function() {\n    if (this.nextPlayer === X) {\n      return MAX;\n    } else {\n      return MIN;\n    }\n  };\n\n  UltimateTicTacToe.prototype.opponent = function(who) {\n    if (who == null) {\n      who = this.nextPlayer;\n    }\n    if (who === X) {\n      return O;\n    } else {\n      return X;\n    }\n  };\n\n  UltimateTicTacToe.prototype.boardsForNextPlay = function() {\n    var i, len, m, ref2, res, v;\n    v = this.lastPlayedPosition != null ? this.a[this.lastPlayedPosition] : null;\n    if ((v != null) && !(isTerminal(v))) {\n      return [this.lastPlayedPosition];\n    } else {\n      res = [];\n      ref2 = this.a;\n      for (i = m = 0, len = ref2.length; m < len; i = ++m) {\n        v = ref2[i];\n        if (!isTerminal(v)) {\n          res.push(i);\n        }\n      }\n      return res;\n    }\n  };\n\n  UltimateTicTacToe.prototype.openPositions = function() {\n    var i, j, js, len, m, n, ref2, res, v;\n    res = [];\n    ref2 = this.boardsForNextPlay();\n    for (m = 0, len = ref2.length; m < len; m++) {\n      i = ref2[m];\n      v = this.a[i];\n      js = [];\n      for (j = n = 0; n < 18; j = n += 2) {\n        if ((0x3 << j & v) === 0) {\n          js.push(j / 2);\n        }\n      }\n      res.push([i, js]);\n    }\n    return res;\n  };\n\n  UltimateTicTacToe.prototype.action = function(ij) {\n    return ij;\n  };\n\n  UltimateTicTacToe.prototype.possibleActions = function() {\n    var i, j, js, len, len1, m, n, ref2, ref3, res;\n    if (this.actions != null) {\n      return this.actions;\n    }\n    res = [];\n    ref2 = this.openPositions();\n    for (m = 0, len = ref2.length; m < len; m++) {\n      ref3 = ref2[m], i = ref3[0], js = ref3[1];\n      for (n = 0, len1 = js.length; n < len1; n++) {\n        j = js[n];\n        res.push([i, j]);\n      }\n    }\n    return this.actions = res;\n  };\n\n  UltimateTicTacToe.prototype.play = function(arg) {\n    var a, i, j;\n    i = arg[0], j = arg[1];\n    a = this.a.slice();\n    a[i] = this.nextPlayer << (j * 2) | a[i];\n    return new this.constructor(a, this.opponent(), j, this.depth + 1);\n  };\n\n  UltimateTicTacToe.prototype.positionForAction = function(action) {\n    return action;\n  };\n\n  UltimateTicTacToe.prototype.utility = function() {\n    var i, j, k, l, len, len1, m, n, ref2, ref3, score, v;\n    score = 0;\n    ref2 = linesU(this.a);\n    for (m = 0, len = ref2.length; m < len; m++) {\n      l = ref2[m];\n      ref3 = [0, 0, 0], i = ref3[0], j = ref3[1], k = ref3[2];\n      for (n = 0, len1 = l.length; n < len1; n++) {\n        v = l[n];\n        if (isWin(v, X)) {\n          ++i;\n        } else if (isWin(v, O)) {\n          ++j;\n        }\n        k += evaluate(v);\n      }\n      if (i === 0 || j === 0) {\n        score += Math.pow(1000, i) - Math.pow(1000, j);\n      }\n      score += k;\n    }\n    return score;\n  };\n\n  UltimateTicTacToe.prototype.toString = function() {\n    var bri, m, n, ri, s, strRows, v, vs;\n    s = '';\n    for (bri = m = 0; m <= 2; bri = ++m) {\n      vs = this.rows()[bri];\n      for (ri = n = 0; n <= 2; ri = ++n) {\n        strRows = (function() {\n          var len, o, results;\n          results = [];\n          for (o = 0, len = vs.length; o < len; o++) {\n            v = vs[o];\n            results.push(\"|\" + (((function() {\n              var len1, p, ref2, results1;\n              ref2 = (rows(v))[ri];\n              results1 = [];\n              for (p = 0, len1 = ref2.length; p < len1; p++) {\n                e = ref2[p];\n                results1.push(decode(e));\n              }\n              return results1;\n            })()).join('|')) + \"|\");\n          }\n          return results;\n        })();\n        s += strRows.join(' ║ ');\n        if (bri < 2 || ri < 2) {\n          s += '\\n';\n        }\n      }\n      if (bri < 2) {\n        s += '════════╬═════════╬════════\\n';\n      }\n    }\n    return s;\n  };\n\n  return UltimateTicTacToe;\n\n})();\n\nmodule.exports = {\n  _: _,\n  X: X,\n  O: O,\n  bin: bin,\n  UltimateTicTacToe: UltimateTicTacToe\n};\n","var MAX, MIN, MinimaxAgent, ref;\n\nref = ['MAX', 'MIN'], MAX = ref[0], MIN = ref[1];\n\nMinimaxAgent = (function() {\n  function MinimaxAgent(depth) {\n    this.depth = depth != null ? depth : Infinity;\n    this.rootAgent = MAX;\n  }\n\n  MinimaxAgent.prototype.nextAction = function(state) {\n    var _, bestAction, ref1;\n    this.rootAgent = state.nextAgent();\n    ref1 = this.minimax(state), _ = ref1[0], bestAction = ref1[1];\n    return bestAction;\n  };\n\n  MinimaxAgent.prototype.minimax = function(state, α, β, ply) {\n    var isTerminal;\n    if (α == null) {\n      α = -Infinity;\n    }\n    if (β == null) {\n      β = +Infinity;\n    }\n    if (ply == null) {\n      ply = 0;\n    }\n    isTerminal = state.isTerminal();\n    if (!isTerminal && state.nextAgent() === this.rootAgent) {\n      ++ply;\n    }\n    if (ply > this.depth || isTerminal) {\n      return [state.utility(), null];\n    } else if (state.nextAgent() === MAX) {\n      return this.maxi(state, α, β, ply);\n    } else {\n      return this.mini(state, α, β, ply);\n    }\n  };\n\n  MinimaxAgent.prototype.maxi = function(state, α, β, ply) {\n    var _, a, action, i, len, nextValue, ref1, ref2, ref3, ref4, successor, v;\n    ref1 = [-Infinity, null], v = ref1[0], a = ref1[1];\n    ref2 = state.possibleActions();\n    for (i = 0, len = ref2.length; i < len; i++) {\n      action = ref2[i];\n      successor = state.play(action);\n      ref3 = this.minimax(successor, α, β, ply), nextValue = ref3[0], _ = ref3[1];\n      if (nextValue > v) {\n        ref4 = [nextValue, action], v = ref4[0], a = ref4[1];\n      }\n      if (v >= β) {\n        return [v, a];\n      }\n      α = Math.max(α, v);\n    }\n    return [v, a];\n  };\n\n  MinimaxAgent.prototype.mini = function(state, α, β, ply) {\n    var _, a, action, i, len, nextValue, ref1, ref2, ref3, ref4, successor, v;\n    ref1 = [+Infinity, null], v = ref1[0], a = ref1[1];\n    ref2 = state.possibleActions();\n    for (i = 0, len = ref2.length; i < len; i++) {\n      action = ref2[i];\n      successor = state.play(action);\n      ref3 = this.minimax(successor, α, β, ply), nextValue = ref3[0], _ = ref3[1];\n      if (nextValue < v) {\n        ref4 = [nextValue, action], v = ref4[0], a = ref4[1];\n      }\n      if (v <= α) {\n        return [v, a];\n      }\n      β = Math.min(β, v);\n    }\n    return [v, a];\n  };\n\n  return MinimaxAgent;\n\n})();\n\nmodule.exports = {\n  MAX: MAX,\n  MIN: MIN,\n  MinimaxAgent: MinimaxAgent\n};\n"],"sourceRoot":"/source/"}